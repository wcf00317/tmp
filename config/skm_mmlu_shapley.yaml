# config/skm_mmlu_shapley.yaml
# Configuration for SKM-Net with Shapley Graph Evolution (Direction 3)

# --- Dataset and Embedding ---
dataset_path: ./datasets/MMLU/mmlu.json
embedding_model: sentence-transformers/all-MiniLM-L6-v2

# --- Agent Definitions (Copied from mmlu.yaml) ---
agents:
  MathSolver:
    llm:
      model_name: qwen-max
    prompt_set: mmlu
  CodeWriter:
    llm:
      model_name: qwen-max
    prompt_set: mmlu
  AdversarialAgent:
    llm:
      model_name: qwen-max
    prompt_set: mmlu
  AnalyzeAgent:
    llm:
      model_name: qwen-max
    prompt_set: mmlu
  FinalMajorVote:
    llm:
      model_name: qwen-max
    prompt_set: mmlu

# --- NEW: Training and Model Hyperparameters ---
training_params:
  # --- Core SKM-Net Parameters ---
  graph_mode: shapley_evolution
  state_dim: 128
  message_dim: 128

  # --- Learning Rates ---
  lr_actor: 0.0001
  lr_critic: 0.001
  lr_gateway: 0.001

  # --- RL & IB Parameters ---
  gamma: 0.99
  beta: 0.001 # IB loss weight

  # --- Shapley Graph Evolution Parameters ---
  credit_alpha: 0.1 # Evolution rate for the credit graph

  # --- Training Process Parameters ---
  max_reasoning_steps: 5
  epochs: 20
  batch_size: 1
  seed: 42
  save_path: checkpoints/skm_manager_shapley.pth